import{c as v,h as y,Q as l}from"./QBtn.54dc9b30.js";import{e as a,c as h,h as _,f,j as w,D as C,g as $,_ as R,G as k,I as r,J as O,K as P,U as c,O as t,L as d}from"./index.e494d06e.js";import{a as p}from"./axios.f1f32898.js";var S=v({name:"QPage",props:{padding:Boolean,styleFn:Function},setup(e,{slots:n}){const{proxy:{$q:g}}=$(),s=f(w,a);if(s===a)return console.error("QPage needs to be a deep child of QLayout"),a;if(f(C,a)===a)return console.error("QPage needs to be child of QPageContainer"),a;const u=h(()=>{const i=(s.header.space===!0?s.header.size:0)+(s.footer.space===!0?s.footer.size:0);if(typeof e.styleFn=="function"){const q=s.isContainer.value===!0?s.containerHeight.value:g.screen.height;return e.styleFn(i,q)}return{minHeight:s.isContainer.value===!0?s.containerHeight.value-i+"px":g.screen.height===0?i!==0?`calc(100vh - ${i}px)`:"100vh":g.screen.height-i+"px"}}),o=h(()=>`q-page${e.padding===!0?" q-layout-padding":""}`);return()=>_("main",{class:o.value,style:u.value},y(n.default))}});const W=k({name:"IndexPage",data(){return{isWaitingResponse:!1,isOpen:!1}},computed:{fqdn(){return localStorage.getItem("fqdn")?localStorage.getItem("fqdn"):new URL(window.location).searchParams.get("fqdn")}},mounted(){this.getGateStatus()},methods:{set_fqdn(){var e=this.$refs.fqdn_input.value;try{e=new URL(e).hostname}catch{}localStorage.setItem("fqdn",e),this.fqdn=e},getGateStatus(){p.request("https://"+this.fqdn+"/hold",{method:"GET"}).then(e=>{console.log("Gate is open: ",e.data.connected),this.isOpen=e.data.connected}).catch(e=>console.log("Error loading gate status",e))},open(e){this.isWaitingResponse=!0,p.request("https://"+this.fqdn+"/hold",{method:"POST",data:e}).then(n=>{console.log("Success opening gate",n),this.isWaitingResponse=!1,this.isOpen=!0}).catch(n=>console.log("Error opening gate",n))},release_hold(){this.isWaitingResponse=!0,p.request("https://"+this.fqdn+"/hold/cancel",{method:"POST"}).then(e=>{console.log("Release hold on gate",e),this.isWaitingResponse=!1,this.isOpen=!1}).catch(e=>console.log("Error release gate hold",e))}}}),b={key:0},I=t("div",{class:"row",style:{"padding-top":"10rem"}},[t("h3",null,"Please set domain name.")],-1),Q={class:"row"},G={type:"text",ref:"fqdn_input"},j={key:1},x={key:0},B=t("div",{class:"row justify-center"},[t("h4",null,"Gate is Open")],-1),E={class:"row justify-center"},F={key:1,class:"row justify-center"},L=t("h4",null,"Gate is Closed",-1),H=[L],K={class:"row"},T={class:"row"};function U(e,n,g,s,m,u){return r(),O(S,{class:"flex justify-center item-start"},{default:P(()=>[e.fqdn?(r(),c("div",j,[e.isOpen?(r(),c("div",x,[B,t("div",E,[d(l,{class:"q-ma-lg q-px-lg q-py-md",loading:e.isWaitingResponse,color:"negative",label:"Release gate hold",onClick:n[1]||(n[1]=o=>e.release_hold())},null,8,["loading"])])])):(r(),c("div",F,H)),t("div",K,[d(l,{class:"q-ma-lg q-px-lg q-py-md",loading:e.isWaitingResponse,color:"warning",label:"Open 1m",onClick:n[2]||(n[2]=o=>e.open(60))},null,8,["loading"]),d(l,{class:"q-ma-lg q-px-lg q-py-md",loading:e.isWaitingResponse,color:"warning",label:"Open 10m",onClick:n[3]||(n[3]=o=>e.open(600))},null,8,["loading"])]),t("div",T,[d(l,{class:"q-ma-lg q-px-lg q-py-md",loading:e.isWaitingResponse,color:"warning",label:"Open 30m",onClick:n[4]||(n[4]=o=>e.open(1800))},null,8,["loading"]),d(l,{class:"q-ma-lg q-px-lg q-py-md",loading:e.isWaitingResponse,color:"warning",label:"Open 60m",onClick:n[5]||(n[5]=o=>e.open(3600))},null,8,["loading"])])])):(r(),c("div",b,[I,t("div",Q,[t("input",G,null,512),t("button",{onClick:n[0]||(n[0]=(...o)=>e.set_fqdn&&e.set_fqdn(...o))},"Save domain name")])]))]),_:1})}var D=R(W,[["render",U]]);export{D as default};
